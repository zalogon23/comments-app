(this["webpackJsonpcomments-app"]=this["webpackJsonpcomments-app"]||[]).push([[0],{34:function(e,t,c){},41:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c(26),s=c.n(a),r=(c(34),c(6)),o=c(3),i=c(5),l=c(7),j=c(27),u=c(0),d=Object(n.createContext)();var b=function(e){var t,c=e.children,a=!1,s=Object(j.a)(document.cookie.split(";"));try{for(s.s();!(t=s.n()).done;){0===t.value.indexOf("connect.sid")&&(a=!0)}}catch(m){s.e(m)}finally{s.f()}var r=Object(n.useState)({logged:a}),i=Object(o.a)(r,2),b=i[0],h=i[1];return Object(n.useEffect)((function(){b.logged&&fetch("/api/profile").then((function(e){return e.json()})).then((function(e){return h(Object(l.a)({logged:!0},e.data))})).catch((function(e){e&&console.log(e)}))}),[]),Object(u.jsx)(d.Provider,{value:[b,h],children:c})},h=Object(n.createContext)();var m=function(e){var t=e.children,c=Object(i.h)().pathname,a=Object(n.useState)(""),s=Object(o.a)(a,2),r=s[0],l=s[1];return""===r&&0===c.indexOf("/topics/search/")&&l(c.slice(15)),Object(u.jsx)(h.Provider,{value:[r,l],children:t})};var O=function(e){var t=e.placeholder,c=e.className,a=Object(n.useState)(""),s=Object(o.a)(a,2),r=s[0],l=s[1],j=Object(n.useContext)(h),d=Object(o.a)(j,2),b=(d[0],d[1]),m=Object(i.g)();return Object(u.jsxs)("form",{children:[Object(u.jsx)("input",{value:r,onChange:function(e){return l(e.target.value)},type:"text",placeholder:t}),Object(u.jsx)("button",{onClick:function(e){if(e.preventDefault(),!r.length)return;m.push("/topics/search/"+r),b(r),l("")},className:c,children:Object(u.jsx)("i",{className:"fas fa-search"})})]})};var p=function(){var e=Object(n.useContext)(d),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(i.h)().pathname,l=Object(i.g)();return Object(u.jsxs)("header",{className:"main-header",children:[0!==s.indexOf("/login")&&(c.logged?Object(u.jsx)("button",{onClick:function(){fetch("/api/logout",{method:"POST"}).then((function(e){return e.json()})).then((function(e){a({logged:!1}),console.log(e),H.removeQueries(),l.push("/")})).catch((function(e){e&&console.log(e)}))},className:"logout",children:"Log Out"}):Object(u.jsx)(r.b,{to:"/login",className:"login",children:"Log In"})),Object(u.jsx)("h1",{className:"title",children:"COMMENTS APP"}),Object(u.jsx)("div",{className:"comment",children:Object(u.jsx)(O,{className:"add add-main",placeholder:"Look for a topic!"})}),Object(u.jsx)("nav",{children:Object(u.jsxs)("ul",{children:[Object(u.jsx)(r.c,{activeClassName:"here",exact:!0,to:"/",children:"Home"}),Object(u.jsx)(r.c,{activeClassName:"here",to:"/profile",children:"Profile"}),Object(u.jsx)(r.c,{activeClassName:"here",to:"/topics",children:"Topics"}),Object(u.jsx)(r.c,{activeClassName:"here",to:"/enemies",children:"Enemies"})]})})]})};var f=function(){return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("main",{className:"home",children:Object(u.jsxs)("div",{className:"content",children:[Object(u.jsx)("h2",{className:"title",children:"Prepare to discuss"}),Object(u.jsx)("p",{className:"intro",children:"Este sitio fue ideado con la premisa de que a todos les gusta hablar mal de algo. Y debido a lo comun que es, he considerado necesario declararlo como un Derecho Humano, el derecho de quejarse de todo. Por lo anterior, esta plataforma simplemente se presenta como un medio de descarga emocional, y... por que no (en el mejor de los casos) como punto de discusiones constructivas y tertulias amenas."}),Object(u.jsxs)("div",{className:"random",children:[Object(u.jsx)("span",{children:"Random Discussion"}),Object(u.jsx)("button",{className:"go-to-comments",children:"Join"})]})]})})})};var x=function(e,t){e.id||fetch("api/profile",{method:"GET"}).then((function(e){return e.json()})).then((function(e){console.log(e),e.error||e.id+100&&t.replace("/")}))};var g=function(){var e=Object(n.useContext)(d),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)(""),j=Object(o.a)(s,2),b=j[0],h=j[1],m=Object(n.useState)(""),O=Object(o.a)(m,2),p=O[0],f=O[1],g=Object(n.useState)(""),N=Object(o.a)(g,2),v=N[0],C=N[1],y=(Object(i.h)().state||{from:{pathname:"/"}}).from,S=Object(i.g)();return Object(n.useEffect)((function(){x(c,S)}),[]),Object(u.jsxs)("main",{className:"login-form",children:[Object(u.jsx)("h3",{className:"title",children:"Login"}),Object(u.jsxs)("form",{children:[Object(u.jsx)("input",{onChange:function(e){return h(e.target.value)},value:b,type:"text",className:"username ".concat("username"===v&&"error-primary"),placeholder:"Username"}),Object(u.jsx)("input",{onChange:function(e){return f(e.target.value)},value:p,type:"password",className:"password ".concat("password"===v&&"error-primary"),placeholder:"Password"}),Object(u.jsx)("button",{onClick:function(e){e.preventDefault(),fetch("api/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:b,password:p})}).then((function(e){return e.json()})).then((function(e){if(!e.error)return a(Object(l.a)(Object(l.a)({},e.data),{},{logged:!0})),console.log(e),void S.replace(y);"username"===e.cause&&C("username"),"password"===e.cause&&C("password")})).catch((function(e){e&&console.log(e)}))},className:"login",children:"Login"})]}),Object(u.jsxs)("div",{className:"register-now",children:[Object(u.jsx)("span",{children:" Have not an account yet? "}),Object(u.jsx)(r.b,{to:"/register",children:"Sign In"})]}),Object(u.jsxs)("div",{className:"reset",children:[Object(u.jsx)("span",{children:" Forgot your password "}),Object(u.jsx)(r.b,{to:"/reset",children:"Reset"})]})]})},N=c(44);function v(){document.querySelector(".image-picker-input").click()}var C=function(e){var t=e.user,c=e.setUser,a=Object(n.useState)(!1),s=Object(o.a)(a,2),r=s[0],i=s[1],j=Object(n.useRef)(),d=Object(n.useState)(!1),b=Object(o.a)(d,2),h=b[0],m=b[1],O=Object(n.useRef)();return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("form",{ref:O,children:[Object(u.jsxs)("div",{className:"avatar-section",children:[Object(u.jsx)("img",{ref:j,onClick:v,className:"image-picker",src:t.profile_image,alt:"Profile"}),Object(u.jsx)("i",{className:"fas fa-camera change-image"}),Object(u.jsx)("input",{name:"avatar",onChange:function(e){e.target.files[0]&&function(e,t){var c=e.target.files[0];if("image/svg+xml"!==c.type){var n=new Blob([c]),a=URL.createObjectURL(n);t.src=a}}(e,j.current);i(!0),void 0===e.target.files[0]&&(j.current.src=t.profile_image,i(!1))},className:"image-picker-input",accept:"image/*",type:"file"}),h&&Object(u.jsx)("p",{className:"loading",children:"The image is uploading"})]}),r&&Object(u.jsxs)("div",{className:"image-actions",children:[Object(u.jsx)("button",{className:"confirmUpdateImage",onClick:function(e){e.preventDefault();var n=new FormData(O.current);console.log(document.forms[1]),m(!0),fetch("/api/profile/avatar",{method:"PUT",body:n}).then((function(e){return e.json()})).then((function(e){c(Object(l.a)(Object(l.a)({},t),{},{profile_image:e.path})),H.refetchQueries("userdata")})).catch((function(e){return alert(e)})).finally((function(){i(!1),m(!1)}))},children:Object(u.jsx)("i",{className:"fas fa-check yes"})}),Object(u.jsx)("button",{className:"cancelUpdateImage",onClick:function(){i(!1),j.current.src=t.profile_image,document.querySelector(".image-picker-input")&&(document.querySelector(".image-picker-input").value="")},children:Object(u.jsx)("i",{className:"fas fa-times"})})]})]})})};var y=function(e){var t=e.user,c=e.setUser,a=Object(n.useState)(!1),s=Object(o.a)(a,2),r=s[0],i=s[1],j=Object(n.useState)(""),d=Object(o.a)(j,2),b=d[0],h=d[1];return Object(u.jsx)("div",{className:"info",children:r?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("textarea",{onChange:function(e){return h(e.target.value)},className:"set-personal-info",value:b}),Object(u.jsxs)("div",{className:"actions",children:[Object(u.jsx)("button",{onClick:function(){fetch("/api/profile/info",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({info:b})}).then((function(e){return e.json()})).then((function(e){c(Object(l.a)(Object(l.a)({},t),{},{profile_info:e.data})),m(),H.removeQueries()})).catch((function(e){e&&console.log(e)}))},className:"set",children:"Set"}),Object(u.jsx)("button",{onClick:m,className:"cancel",children:"Cancel"})]})]}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("p",{children:t.profile_info}),Object(u.jsx)("button",{onClick:function(){i(!0),h(t.profile_info)},className:"edit",children:"Edit"})]})});function m(){i(!1)}};var S=function(){var e=Object(n.useContext)(d),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(N.a)("userdata",(function(){return fetch("/api/profile").then((function(e){return e.json()}))}));return Object(n.useEffect)((function(){s.isSuccess&&a(Object(l.a)(Object(l.a)({},c),s.data.data))}),[]),Object(u.jsx)("main",{className:"profile",children:s.isLoading?Object(u.jsx)("div",{className:"loading",children:"It is loading..."}):s.isError?Object(u.jsx)("div",{className:"error",children:"There was an error fetching. Please log out and try again"}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(C,{user:c,setUser:a}),Object(u.jsxs)("div",{className:"content",children:[Object(u.jsx)("h3",{className:"name",children:c.username}),Object(u.jsx)(y,{user:c,setUser:a})]})]})})};var T=function(){var e=Object(i.g)(),t=Object(n.useContext)(d),c=Object(o.a)(t,1)[0],a=Object(n.useState)(""),s=Object(o.a)(a,2),r=s[0],l=s[1],j=Object(n.useState)(""),b=Object(o.a)(j,2),h=b[0],m=b[1],O=Object(n.useState)(""),p=Object(o.a)(O,2),f=p[0],g=p[1],N=Object(n.useState)(""),v=Object(o.a)(N,2),C=v[0],y=v[1],S=Object(n.useState)(!1),T=Object(o.a)(S,2),w=T[0],k=T[1];return Object(n.useEffect)((function(){x(c,e)}),[]),Object(u.jsxs)("main",{className:"register-form",children:[Object(u.jsx)("h3",{className:"title",children:"Register"}),Object(u.jsxs)("form",{children:[Object(u.jsx)("input",{onChange:function(e){return m(e.target.value)},type:"text",className:"username ".concat("username"===r&&"error-primary"),placeholder:"Username",value:h}),Object(u.jsx)("input",{onChange:function(e){return g(e.target.value)},type:"password",className:"password ".concat("password"===r&&"error-primary"),placeholder:"Password",value:f}),Object(u.jsx)("input",{onChange:function(e){return y(e.target.value)},type:"email",className:"email ".concat("email"===r&&"error-primary"),placeholder:"Email",value:C}),Object(u.jsx)("button",{onClick:function(t){if(w)return;k(!0),t.preventDefault(),fetch("api/register",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:h,password:f,email:C})}).then((function(e){return e.json()})).then((function(t){console.log(t),t.error?("username"===t.cause&&l("username"),"password"===t.cause&&l("password"),"email"===t.cause&&l("email")):e.replace("/login")})).catch((function(e){console.log(e),e&&console.log("No se pudo enviar la data...")})).finally((function(){return k(!1)}))},className:"register",children:"Register"})]})]})},w=c(20);var k=function e(t){var c=t.source,a=Object(n.useState)(!1),s=Object(o.a)(a,2),j=s[0],b=s[1],h=Object(n.useState)(!1),m=Object(o.a)(h,2),O=m[0],p=m[1],f=Object(n.useState)(""),x=Object(o.a)(f,2),g=x[0],N=x[1],v=Object(n.useContext)(d),C=Object(o.a)(v,1)[0],y=Object(n.useState)(JSON.parse(c.children)),S=Object(o.a)(y,2),T=S[0],k=S[1],E=c.commenting,P=c.setCommenting,F=Object(i.g)(),U=Object(n.useRef)();return Object(n.useEffect)((function(){document.activeElement.blur(),U.current&&U.current.focus()}),[j]),Object(u.jsxs)("article",{className:"comment ".concat(c.id),children:[Object(u.jsx)(r.b,{className:"author",to:c.author===C.id?"/profile":"/users/".concat(c.author),children:c.authorName}),Object(u.jsx)("p",{className:"content",children:c.content}),Object(u.jsxs)("ul",{className:"actions",children:[j?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("input",{ref:U,value:g,onChange:function(e){return N(e.target.value)},type:"text",className:"answer-comment"}),Object(u.jsx)("button",{onClick:function(e){b(!1),P(!1),N(""),fetch("/api/comment/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({topic:c.topic,content:g,parent:c.id})}).then((function(e){return e.json()})).then((function(e){k([].concat(Object(w.a)(T),[e.data])),O||L()})).catch((function(e){e&&console.log(e)}))},className:"send-answer-comment",children:"Send"}),Object(u.jsx)("button",{onClick:function(){b(!1),P(!1)},className:"abort-answer-comment",children:"\xd7"})]}):Object(u.jsxs)(u.Fragment,{children:[!!T.length&&Object(u.jsx)("button",{onClick:L,className:"see-more",children:"..."}),Object(u.jsx)("button",{onClick:function(){E||(C.logged||F.push("/login"),b(!0),P(!0))},className:"answer",children:"+"})]}),C.id===c.author&&Object(u.jsx)("button",{onClick:function(e){return t=c.id,c.setChildComments(c.childComments.filter((function(e){return e.id!==t}))),void fetch("/api/comment",{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:t})}).then((function(e){return e.json()})).then((function(e){return console.log(e)})).catch((function(e){e&&console.log(e)})).finally((function(){document.querySelector(".answer-comment")||P(!1)}));var t},className:"delete",children:Object(u.jsx)("i",{className:"fa fa-trash","aria-hidden":"true"})})]}),Object(u.jsx)("ol",{className:"children",children:!!T.length&&O&&T.map((function(t){return Object(u.jsx)(e,{source:Object(l.a)(Object(l.a)({},t),{},{childComments:T,setChildComments:k,commenting:E,setCommenting:P})},t.id+1e9)}))})]});function L(){!1!==O?p(!1):fetch("/api/comment/".concat(c.id)).then((function(e){return e.json()})).then((function(e){return k(e)})).catch((function(e){return console.log(e)})).finally((function(){return p(!0)}))}};var E=function(){var e=Object(i.h)().pathname,t=Object(n.useContext)(d),c=Object(o.a)(t,1)[0],a=Object(n.useState)(""),s=Object(o.a)(a,2),r=s[0],j=s[1],b=Object(n.useState)(""),h=Object(o.a)(b,2),m=h[0],O=h[1],p=Object(i.g)(),f=Object(n.useState)([]),x=Object(o.a)(f,2),g=x[0],N=x[1],v=Object(n.useState)(!1),C=Object(o.a)(v,2),y=C[0],S=C[1],T=Object(n.useState)(""),E=Object(o.a)(T,2),P=E[0],F=E[1];return Object(n.useEffect)((function(){console.log("/api"+e),fetch("/api"+e).then((function(e){return e.json()})).then((function(e){var t=e.topic,c=e.comments;O(t),N(c),console.log(t)})).catch((function(e){e&&console.log(e)}))}),[]),Object(u.jsx)(u.Fragment,{children:m.subject&&m.intro?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("main",{className:"topic",children:[Object(u.jsx)("h3",{className:"title",children:m.subject[0].toUpperCase()+m.subject.slice(1)}),Object(u.jsx)("p",{className:"intro",children:m.intro})]}),Object(u.jsxs)("article",{className:"actions",children:[Object(u.jsx)("input",{type:"text",className:"comment-content ".concat("main"===r&&"error-primary"),onChange:function(e){return F(e.target.value)},value:P}),Object(u.jsx)("button",{className:"add-comment",onClick:function(){c.logged||p.push("/login");if(!P.length)return void j("main");j(""),fetch("/api/comment",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({topic:m.id,parent:null,content:P})}).then((function(e){return e.json()})).then((function(e){F(""),N([].concat(Object(w.a)(g),[Object(l.a)(Object(l.a)({},e.data),{},{authorName:c.username})]))})).catch((function(e){return console.log(e)}))},children:"+"})]}),Object(u.jsx)("section",{className:"comments",children:g.map((function(e){return Object(u.jsx)(k,{source:Object(l.a)(Object(l.a)({},e),{},{childComments:g,setChildComments:N,commenting:y,setCommenting:S})},e.id+1e7)}))})]}):Object(u.jsx)("p",{children:"Loading..."})})};var P=function(){var e=Object(n.useContext)(d),t=Object(o.a)(e,1)[0],c=Object(N.a)("topics",(function(){return fetch("/api/topics").then((function(e){return e.json()}))}));return console.log(c),Object(u.jsxs)(u.Fragment,{children:[t.logged&&Object(u.jsx)("section",{className:"create-topic",children:Object(u.jsx)(r.b,{to:"/topics/create",className:"add-topic",children:"Add a new topic!"})}),Object(u.jsx)("main",{className:"topics",children:c.isLoading?Object(u.jsx)("div",{children:" Loading... "}):c.isError?Object(u.jsx)("div",{children:" There was an error, please refresh "}):Object(u.jsx)(u.Fragment,{children:c.data.data.map((function(e){return Object(u.jsxs)("article",{className:"topic ".concat(e.id),children:[Object(u.jsxs)(r.b,{to:"/topics/".concat(e.id),children:[Object(u.jsx)("div",{className:"rating",children:[1,2,3,4,5].map((function(t){return t<=e.rating?Object(u.jsx)("i",{className:"fas fa-star"},t):Object(u.jsx)("i",{className:"far fa-star"},t+100)}))}),Object(u.jsx)("h3",{className:"title",children:e.subject[0].toUpperCase()+e.subject.slice(1)}),Object(u.jsx)("p",{className:"content",children:e.intro}),Object(u.jsx)("h4",{className:"founder",children:e.authorName})]}),e.author===t.id&&Object(u.jsx)("button",{onClick:function(){return t=e.id,void fetch("/api/topics",{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:t})}).then((function(e){return e.json()})).then((function(e){console.log(e),H.refetchQueries("topics")})).catch((function(e){return console.log(e)}));var t},className:"delete",children:Object(u.jsx)("i",{className:"fa fa-trash","aria-hidden":"true"})})]},e.id)}))})})]})};var F=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)(""),r=Object(o.a)(s,2),j=r[0],d=r[1],b=Object(i.g)();return Object(u.jsxs)("main",{className:"create-topic",children:[Object(u.jsx)("h3",{className:"title",children:"What topic would you like to create?"}),Object(u.jsxs)("form",{className:"topic-info",children:[Object(u.jsx)("input",{placeholder:"Topic's title",type:"text",className:"subject",value:c,onChange:function(e){return a(e.target.value)}}),Object(u.jsx)("textarea",{placeholder:"A small introduction...",className:"intro",value:j,onChange:function(e){return d(e.target.value)}}),Object(u.jsx)("button",{className:"create",onClick:function(e){if(e.preventDefault(),!c.length||!j.length)return;var t=(s=j,s.charAt(0).toUpperCase()+s.slice(1)),n={subject:c,intro:t};var s;fetch("/api/topics",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(Object(l.a)({},n))}).then((function(e){return e.json()})).then((function(e){console.log(e),d(""),a(""),b.push("/topics")})).catch((function(e){return console.log(e)}))},children:"Create!"})]})]})};var U=function(){var e=Object(n.useContext)(h),t=Object(o.a)(e,1)[0],c=Object(n.useContext)(d),a=Object(o.a)(c,1)[0],s=Object(N.a)(["searchedTopics",{search:t}],(function(e){var t=e.queryKey,c=Object(o.a)(t,2),n=(c[0],c[1].search);return fetch("/api/topics/search/".concat(n)).then((function(e){return e.json()}))}));return console.log(s),Object(u.jsx)("main",{className:"topics",children:s.isFetching?Object(u.jsx)("p",{children:"It is loading"}):s.isError?Object(u.jsx)("p",{children:"There was an error, please try another topic"}):s.data.data.length?Object(u.jsx)(u.Fragment,{children:s.data.data.map((function(e){return Object(u.jsxs)("article",{className:"topic ".concat(e.id),children:[Object(u.jsxs)(r.b,{to:"/topics/".concat(e.id),children:[Object(u.jsx)("div",{className:"rating",children:[1,2,3,4,5].map((function(t){return t<=e.rating?Object(u.jsx)("i",{className:"fas fa-star"},t):Object(u.jsx)("i",{className:"far fa-star"},t+100)}))}),Object(u.jsx)("h3",{className:"title",children:e.subject[0].toUpperCase()+e.subject.slice(1)}),Object(u.jsx)("p",{className:"content",children:e.intro}),Object(u.jsx)("h4",{className:"founder",children:e.authorName})]}),e.author===a.id&&Object(u.jsx)("button",{onClick:function(){return t=e.id,void fetch("/api/topics",{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:t})}).then((function(e){return e.json()})).then((function(e){console.log(e),H.refetchQueries("searchedTopics")})).catch((function(e){return console.log(e)}));var t},className:"delete",children:Object(u.jsx)("i",{className:"fa fa-trash","aria-hidden":"true"})})]},e.id)}))}):Object(u.jsxs)("section",{className:"no-matches",children:[Object(u.jsx)("p",{children:"There is no matching topic, sorry"}),Object(u.jsx)(r.b,{to:"/topics",children:"Go to Topics"})]})})};var L=function(){return Object(u.jsxs)(i.d,{children:[Object(u.jsx)(i.b,{exact:!0,path:"/topics",component:P}),Object(u.jsx)(i.b,{path:"/topics/create",component:F}),Object(u.jsx)(i.b,{exact:!0,path:"/topics/search/:search",component:U}),Object(u.jsx)(i.b,{exact:!0,path:"/topics/:id",component:E})]})};var A=function(){var e,t=Object(n.useContext)(d),c=Object(o.a)(t,1)[0],a=Object(N.a)("enemies",(function(){return fetch("/api/friends").then((function(e){return e.json()}))}),{enabled:!!c.id});return Object(u.jsxs)("main",{className:"enemies",children:[Object(u.jsx)("h2",{className:"title",children:"Your enemies"}),c.id?a.isFetching?Object(u.jsx)("div",{className:"loading",children:"It is loading..."}):a.isError?Object(u.jsx)("div",{className:"error",children:"There was an error, please refresh"}):!(null===(e=a.data)||void 0===e?void 0:e.data.length)&&c.id?Object(u.jsx)("article",{className:"no-friends",children:"There are no friends to show, man."}):a.data.data.map((function(e){return Object(u.jsxs)(r.b,{to:"/users/".concat(e.id),className:"friend",children:[Object(u.jsx)("img",{src:e.profile_image,alt:e.username,className:"avatar"}),Object(u.jsxs)("div",{className:"info",children:[Object(u.jsx)("h3",{className:"username",children:e.username}),Object(u.jsx)("p",{className:"info",children:e.profile_info})]})]},e.id)})):Object(u.jsxs)("article",{className:"no-friends",children:[Object(u.jsx)("p",{children:"You should login to see your friends"}),Object(u.jsx)(r.b,{to:"/login",className:"login",children:"Login"})]})]})};var J=function(){var e,t=Object(i.i)().params.id,c=Object(n.useContext)(d),a=Object(o.a)(c,1)[0],s=Object(i.g)(),r=Object(N.a)("anotheruser",(function(){return fetch("/api/users/"+t).then((function(e){return e.json()}))}),{cacheTime:0});return Object(u.jsx)("main",{className:"profile user",children:r.isLoading?Object(u.jsx)("div",{className:"loading",children:"It is loading..."}):r.isError?Object(u.jsx)("div",{className:"error",children:"There was an error fetching. Please log out and try again"}):!r.isFetching&&(null===(e=r.data)||void 0===e?void 0:e.data)?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"avatar-section",children:Object(u.jsx)("img",{className:"image-picker",src:"/"+r.data.data.profile_image,alt:"Profile"})}),Object(u.jsxs)("div",{className:"content",children:[Object(u.jsx)("h3",{className:"name",children:r.data.data.username}),Object(u.jsxs)("div",{className:"info",children:[Object(u.jsx)("p",{children:r.data.data.profile_info}),a.id&&JSON.parse(r.data.data.friends).includes(a.id)?Object(u.jsx)("button",{onClick:function(){return l(r.data.data.id)},className:"remove-friend",children:Object(u.jsx)("i",{className:"fas fa-user-times"})}):Object(u.jsx)("button",{onClick:function(){return l(r.data.data.id)},className:"add-friend",children:Object(u.jsx)("i",{className:"fas fa-user-plus"})})]})]})]}):Object(u.jsx)(u.Fragment,{})});function l(e){a.id||s.push("/login"),fetch("/api/friends",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:e})}).then((function(e){return e.json()})).then((function(e){console.log(e),H.refetchQueries("anotheruser")})).catch((function(e){return console.log(e)}))}};var R=function(e){var t=Object(n.useContext)(d),c=Object(o.a)(t,1)[0].logged,a=Object(i.h)();return Object(u.jsx)(u.Fragment,{children:c?Object(u.jsx)(i.b,Object(l.a)({},e)):Object(u.jsx)(i.a,{to:{pathname:"/login",state:{from:a}}})})};var D=function(e){var t=Object(n.useContext)(d),c=Object(o.a)(t,1)[0];console.log(c.logged?"Already logged":"Isnt logged yet");var a=c.logged;return Object(u.jsx)(u.Fragment,{children:a?Object(u.jsx)(i.a,{to:{pathname:"/"}}):Object(u.jsx)(i.b,Object(l.a)({},e))})};var I=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)(!1),r=Object(o.a)(s,2),i=r[0],l=r[1],j=Object(n.useState)(!1),d=Object(o.a)(j,2),b=d[0],h=d[1];return Object(u.jsxs)("main",{className:"reset-form",children:[Object(u.jsx)("h3",{className:"title",children:"Reset Password"}),b?Object(u.jsx)("p",{className:"done",children:"The email has been sent. Go to check it out"}):Object(u.jsxs)("form",{children:[Object(u.jsx)("input",{onChange:function(e){return a(e.target.value)},value:c,type:"email",placeholder:"Email"}),Object(u.jsx)("button",{onClick:function(e){if(e.preventDefault(),i)return;l(!0),fetch("/api/users/reset",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:c})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.error||h(!0)})).catch((function(e){return console.log(e)})).finally((function(){l(!1)}))},className:"reset",children:"Send Reset Request"})]}),i&&Object(u.jsx)("p",{className:"loading",children:"Is loading..."})]})};var _=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),c=t[0],a=t[1],s=Object(n.useState)(!1),l=Object(o.a)(s,2),j=l[0],d=l[1],b=Object(n.useState)(!1),h=Object(o.a)(b,2),m=h[0],O=h[1],p=Object(i.i)().params,f=new URLSearchParams(p.algo),x=f.get("resetKey"),g=f.get("id");return Object(u.jsxs)("main",{className:"reset-form",children:[Object(u.jsx)("h3",{className:"title",children:"Reset Password"}),m?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("p",{className:"done",children:"The password has been updated"}),Object(u.jsx)(r.b,{to:"/login",children:"Login"})]}):Object(u.jsxs)("form",{children:[Object(u.jsx)("input",{onChange:function(e){return a(e.target.value)},value:c,type:"password",placeholder:"Password"}),Object(u.jsx)("button",{onClick:function(e){if(e.preventDefault(),j)return;d(!0),fetch("/api/users/reset",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({password:c,resetKey:x,id:g})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.error||O(!0)})).catch((function(e){return console.log(e)})).finally((function(){d(!1)}))},className:"reset-password",children:"Reset Password"})]}),j&&Object(u.jsx)("p",{className:"loading",children:"Is loading..."})]})};var q=function(){return Object(u.jsxs)(i.d,{children:[Object(u.jsx)(i.b,{exact:!0,path:"/",component:f}),Object(u.jsx)(D,{path:"/login",component:g}),Object(u.jsx)(D,{path:"/register",component:T}),Object(u.jsx)(D,{path:"/reset/:algo",component:_}),Object(u.jsx)(D,{exact:!0,path:"/reset",component:I}),Object(u.jsx)(R,{path:"/profile",component:S}),Object(u.jsx)(i.b,{path:"/topics",component:L}),Object(u.jsx)(i.b,{path:"/enemies",component:A}),Object(u.jsx)(i.b,{path:"/users/:id",component:J})]})},Q=c(43),G=c(29),H=new Q.a;var K=function(){return Object(u.jsx)(G.a,{client:H,children:Object(u.jsx)(r.a,{children:Object(u.jsx)(m,{children:Object(u.jsxs)(b,{children:[Object(u.jsx)(p,{}),Object(u.jsx)(q,{})]})})})})};s.a.render(Object(u.jsx)(K,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.a76a0d48.chunk.js.map