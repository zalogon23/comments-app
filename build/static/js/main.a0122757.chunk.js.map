{"version":3,"sources":["scripts/context/AuthProvider.js","scripts/components/Header.js","scripts/pages/Home.js","scripts/logic/checkLoginToRedirect.js","scripts/pages/Login.js","scripts/logic/uploadImage.js","scripts/components/AvatarPicker.js","scripts/components/ProfileInfoEditor.js","scripts/pages/Profile.js","scripts/pages/Register.js","scripts/components/Comment.js","scripts/pages/Topic.js","scripts/pages/TopicCreate.js","scripts/pages/Topics.js","scripts/pages/Users.js","scripts/routes/PrivateRoute.js","scripts/routes/PublicRoute.js","scripts/routes/AllRoutes.js","App.js","index.js"],"names":["authContext","createContext","AuthProvider","children","hasSiteCookie","document","cookie","split","indexOf","useState","logged","user","setUser","useEffect","fetch","then","res","json","result","data","catch","err","console","log","Provider","value","Header","useContext","path","useLocation","pathname","className","onClick","method","client","removeQueries","to","type","placeholder","activeClassName","exact","Home","checkLoginToRedirect","history","id","error","replace","Login","username","setUsername","password","setPassword","wrong","setWrong","from","state","useHistory","onChange","e","target","preventDefault","headers","body","JSON","stringify","userData","cause","openImagePicker","querySelector","click","AvatarPicker","open","setOpen","avatarImageEl","useRef","ref","src","profile_image","alt","imageData","FormData","forms","alert","refetchQueries","finally","current","name","files","userImage","image","blobImage","Blob","url","URL","createObjectURL","updateProfileImage","undefined","accept","ProfileInfoEditor","edit","setEdit","profileInfo","setProfileInfo","info","profile_info","exitEditMode","Profile","queryResult","useQuery","isSuccess","isLoading","isError","Register","Comment","source","commentMode","setCommentMode","showChildComments","setShowChildComments","answerContent","setAnswerContent","parse","childComments","setChildComments","commenting","setCommenting","activeElement","blur","focus","author","authorName","content","topic","parent","toggleChildCommentsVisibility","length","push","filter","comment","aria-hidden","map","child","Topic","setTopic","mainComment","setMainComment","resTopic","resComments","comments","subject","intro","TopicCreate","setSubject","setIntro","formattedSubject","formatText","formattedIntro","text","charAt","toUpperCase","slice","Topics","topics","useRouteMatch","rate","rating","invalidateQueries","component","Users","params","anotherUser","cacheTime","PrivateRoute","props","location","PublicRoute","AllRoutes","QueryClient","App","QueryClientProvider","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.a0122757.chunk.js","sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\n\r\nexport const authContext = createContext();\r\n\r\nfunction AuthProvider({ children }) {\r\n  let hasSiteCookie = false;\r\n  for (const cookiePair of document.cookie.split(\";\")) {\r\n    if (cookiePair.indexOf(\"connect.sid\") === 0) hasSiteCookie = true;\r\n  }\r\n  const [user, setUser] = useState({ logged: hasSiteCookie });\r\n\r\n  useEffect(() => {\r\n    if(user.logged){\r\n      fetch(\"/api/profile\")\r\n      .then(res => res.json())\r\n      .then(result => setUser({logged: true, ...result.data}))\r\n      .catch(err => { if (err) console.log(err) })\r\n    }\r\n  }, [])\r\n\r\n  return (\r\n    <authContext.Provider value={[user, setUser]}>\r\n      {children}\r\n    </authContext.Provider>\r\n  )\r\n}\r\n\r\nexport default AuthProvider;\r\n","import React, { useContext } from \"react\";\r\nimport { NavLink, Link, useLocation } from \"react-router-dom\";\r\nimport { client } from \"../../App\";\r\nimport { authContext } from \"../context/AuthProvider\";\r\n\r\nfunction Header() {\r\n\r\n  const [user, setUser] = useContext(authContext);\r\n  const { pathname: path } = useLocation();\r\n\r\n  return (\r\n    <header className=\"main-header\">\r\n      {path.indexOf(\"/login\") !== 0 && (user.logged ?\r\n        <button onClick={logout} className=\"logout\">Log Out</button>\r\n        :\r\n        <Link to=\"/login\" className=\"login\">Log In</Link>)\r\n      }\r\n      <h1 className=\"title\">COMMENTS APP</h1>\r\n      <div className=\"comment\">\r\n        <input type=\"text\" placeholder=\"Look for a topic...\" />\r\n        <button className=\"add add-main\"><i className=\"fas fa-search\"></i></button>\r\n      </div>\r\n      <nav>\r\n        <ul>\r\n          <NavLink activeClassName=\"here\" exact to=\"/\">Home</NavLink>\r\n          <NavLink activeClassName=\"here\" to=\"/profile\">Profile</NavLink>\r\n          <NavLink activeClassName=\"here\" to=\"/topics\">Topics</NavLink>\r\n          <NavLink activeClassName=\"here\" to=\"/enemies\">Enemies</NavLink>\r\n        </ul>\r\n      </nav>\r\n    </header>\r\n  )\r\n\r\n  function logout() {\r\n    fetch(\"/api/logout\", {\r\n      method: \"POST\"\r\n    })\r\n      .then(res => res.json())\r\n      .then(result => {\r\n        setUser({ logged: false });\r\n        console.log(result);\r\n        client.removeQueries();\r\n      })\r\n      .catch(err => { if(err) console.log(err) })\r\n  }\r\n}\r\n\r\nexport default Header;","import React from \"react\";\r\n\r\nfunction Home() {\r\n  return (\r\n    <>\r\n      <main className=\"home\">\r\n        <div className=\"content\">\r\n          <h2 className=\"title\">Prepare to discuss</h2>\r\n          <p className=\"intro\">\r\n            Este sitio fue ideado con la premisa de que a todos les gusta hablar mal de algo.\r\n            Y debido a lo comun que es, he considerado necesario declararlo como un Derecho Humano,\r\n            el derecho de quejarse de todo. Por lo anterior, esta plataforma simplemente se presenta\r\n            como un medio de descarga emocional, y... por que no (en el mejor de los casos) como punto\r\n            de discusiones constructivas y tertulias amenas.\r\n          </p>\r\n          <div className=\"random\">\r\n            <span>Random Discussion</span><button className=\"go-to-comments\">Join</button>\r\n          </div>\r\n        </div>\r\n      </main>\r\n      {/* <section className=\"hottest-topics\">\r\n        <article className=\"topic\">Games</article>\r\n        <article className=\"topic\">War</article>\r\n        <article className=\"topic\">Heroes</article>\r\n        <article className=\"topic\">Religion</article>\r\n      </section> */}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Home;","function checkLoginToRedirect(user, history) {\r\n  if (user.id) return;\r\n  fetch(\"api/profile\", {\r\n    method: \"GET\"\r\n  })\r\n    .then(res => res.json())\r\n    .then(user => {\r\n      console.log(user);\r\n      if (user.error) return;\r\n      if (!(user.id + 100)) return;\r\n      history.replace(\"/\");\r\n    })\r\n}\r\n\r\nexport default checkLoginToRedirect","import React, { useContext, useEffect, useState } from 'react'\r\nimport { useHistory, useLocation, Link } from 'react-router-dom';\r\nimport { authContext } from \"../context/AuthProvider\"\r\nimport checkLoginToRedirect from '../logic/checkLoginToRedirect';\r\n\r\nfunction Login() {\r\n\r\n  const [user, setUser] = useContext(authContext);\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [ wrong, setWrong ] = useState(\"\");\r\n  const { from } = useLocation().state || { from: { pathname: \"/\" } };\r\n  const history = useHistory();\r\n  useEffect(() => {\r\n    checkLoginToRedirect(user, history);\r\n  }, []);\r\n\r\n  return (\r\n    <main className=\"login-form\">\r\n      <h3 className=\"title\">Login</h3>\r\n      <form>\r\n        <input onChange={(e) => setUsername(e.target.value)} value={username} type=\"text\" className={`username ${wrong === \"username\" && \"error-primary\"}`} placeholder=\"Username\" />\r\n        <input onChange={(e) => setPassword(e.target.value)} value={password} type=\"password\" className={`password ${wrong === \"password\" && \"error-primary\"}`} placeholder=\"Password\" />\r\n        <button onClick={login} className=\"login\">Login</button>\r\n      </form>\r\n      <div className=\"register-now\">      \r\n        <span> Have not an account yet? </span><Link to=\"/register\">Sign In</Link>\r\n      </div>\r\n    </main>\r\n  )\r\n\r\n  function login(e) {\r\n    e.preventDefault();\r\n    fetch(\"api/login\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Accept\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({ username, password })\r\n    })\r\n      .then(res => res.json())\r\n      .then(userData => {\r\n        if (!userData.error) {\r\n          setUser({ ...userData.data, logged: true });\r\n          console.log(userData);\r\n          history.replace(from);\r\n          return\r\n        }\r\n        if(userData.cause === \"username\"){\r\n          setWrong(\"username\");\r\n        }\r\n        if(userData.cause === \"password\"){\r\n          setWrong(\"password\");\r\n        }\r\n      })\r\n      .catch(err => { if (err) console.log(err) })\r\n  }\r\n}\r\n\r\n\r\nexport default Login\r\n","function openImagePicker() {\r\n  document.querySelector(\".image-picker-input\").click();\r\n}\r\n\r\nfunction updateProfileImage(e, userImage){\r\n  const image = e.target.files[0];\r\n  if(image.type === \"image/svg+xml\") return; //Filter\r\n  const blobImage = new Blob([image]);\r\n  const url = URL.createObjectURL(blobImage);\r\n  userImage.src = url;\r\n}\r\n\r\nexport { openImagePicker, updateProfileImage };\r\n","import React, { useRef, useState } from 'react'\r\nimport { client } from '../../App';\r\nimport { openImagePicker, updateProfileImage } from '../logic/uploadImage';\r\n\r\nfunction AvatarPicker({ user, setUser }) {\r\n\r\n  const [ open, setOpen ] = useState(false);\r\n  const avatarImageEl = useRef();\r\n\r\n  return (\r\n    <form className=\"avatar-section\">\r\n      <img ref={avatarImageEl} onClick={openImagePicker} className=\"image-picker\" src={user.profile_image} alt=\"Profile\" />\r\n      {open &&\r\n        <div className=\"image-actions\">\r\n          <button className=\"confirmUpdateImage\" onClick={sendUpdatedProfileImage}><i className=\"fas fa-check yes\"></i></button>\r\n          <button className=\"cancelUpdateImage\" onClick={cancelImagePicker}><i className=\"fas fa-times\"></i></button>\r\n        </div>\r\n      }\r\n      <i className=\"fas fa-camera change-image\"></i>\r\n      <input name=\"avatar\" onChange={toggleImageOnClient} className=\"image-picker-input\" accept=\"image/*\" type=\"file\" />\r\n    </form>\r\n  )\r\n\r\n  function toggleImageOnClient(e) {\r\n    if (e.target.files[0]) updateProfileImage(e, avatarImageEl.current);\r\n    setOpen(true);\r\n    if (e.target.files[0] === undefined) {\r\n      avatarImageEl.current.src = user.profile_image;\r\n      setOpen(false);\r\n    }\r\n  }\r\n  \r\n  function cancelImagePicker() {\r\n    setOpen(false);\r\n    avatarImageEl.current.src = user.profile_image;\r\n    if (document.querySelector(\".image-picker-input\")) document.querySelector(\".image-picker-input\").value = \"\";\r\n  }\r\n\r\n  function sendUpdatedProfileImage(e) {\r\n    e.preventDefault();\r\n    const imageData = new FormData(document.forms[0]);\r\n    fetch(\"/api/profile/avatar\", {\r\n      method: \"PUT\",\r\n      body: imageData\r\n    })\r\n      .then(res => res.json())\r\n      .then(result => {\r\n        alert(result);\r\n        setUser({ ...user, profile_image: result.path });\r\n        client.refetchQueries(\"userdata\"); //Destroy the results of global User for refreshing\r\n      })\r\n      .catch(err => alert(err))\r\n      .finally(() => setOpen(false))\r\n  }\r\n}\r\n\r\nexport default AvatarPicker\r\n","import React, { useState } from 'react'\r\nimport { client } from '../../App';\r\n\r\nfunction ProfileInfoEditor({ user, setUser }) {\r\n\r\n  const [edit, setEdit] = useState(false);\r\n  const [profileInfo, setProfileInfo] = useState(\"\");\r\n\r\n  return (\r\n    <div className=\"info\">\r\n      {!edit ?\r\n        <>\r\n          <p>{user.profile_info}</p>\r\n          <button onClick={openEditMode} className=\"edit\">Edit</button>\r\n        </>\r\n        :\r\n        <>\r\n          <textarea onChange={(e) => setProfileInfo(e.target.value)} className=\"set-personal-info\" value={profileInfo} />\r\n          <div className=\"actions\">\r\n            <button onClick={updateProfileInfo} className=\"set\">Set</button>\r\n            <button onClick={exitEditMode} className=\"cancel\">Cancel</button>\r\n          </div>\r\n        </>\r\n      }\r\n    </div>\r\n  )\r\n\r\n  function exitEditMode() {\r\n    setEdit(false);\r\n  }\r\n\r\n  function openEditMode() {\r\n    setEdit(true);\r\n    setProfileInfo(user.profile_info);\r\n  }\r\n\r\n  function updateProfileInfo() {\r\n    fetch(\"/api/profile/info\", {\r\n      method: \"PUT\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Accept\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({\r\n        info: profileInfo\r\n      })\r\n    })\r\n      .then(res => res.json())\r\n      .then(result => {\r\n        setUser({ ...user, profile_info: result.data });\r\n        exitEditMode();\r\n        client.removeQueries();\r\n      })\r\n      .catch(err => {\r\n        if (err) {\r\n          console.log(err);\r\n        }\r\n      })\r\n  }\r\n}\r\n\r\nexport default ProfileInfoEditor\r\n","import React, { useEffect, useContext } from 'react';\r\nimport { authContext } from '../context/AuthProvider';\r\nimport { useQuery } from \"react-query\";\r\nimport AvatarPicker from '../components/AvatarPicker';\r\nimport ProfileInfoEditor from '../components/ProfileInfoEditor';\r\n\r\nfunction Profile() {\r\n\r\n  const [user, setUser] = useContext(authContext);\r\n  const queryResult = useQuery(\"userdata\", () => fetch(\"/api/profile\").then(res => res.json()));\r\n\r\n  useEffect(() => {\r\n    if (queryResult.isSuccess) setUser({ ...user, ...queryResult.data.data });\r\n  }, []);\r\n\r\n  return (\r\n    <main className=\"profile\">\r\n      {queryResult.isLoading ?\r\n        <div className=\"loading\">It is loading...</div>\r\n        :\r\n        queryResult.isError ?\r\n          <div className=\"error\">There was an error fetching. Please log out and try again</div>\r\n          :\r\n          <>\r\n            <AvatarPicker {...{user, setUser}} />\r\n            <div className=\"content\">\r\n              <h3 className=\"name\">{user.username}</h3>\r\n              <ProfileInfoEditor {...{ user, setUser }} />\r\n              {/* <div style={{ display: \"none\" }} className=\"trophies\">\r\n                <div className=\"trophy speaker\">M</div>\r\n                <div className=\"trophy devil\">M</div>\r\n                <div className=\"trophy badass\">M</div>\r\n              </div> */}\r\n            </div>\r\n          </>\r\n      }\r\n    </main>\r\n  )\r\n}\r\n\r\nexport default Profile\r\n","import React, { useContext, useState, useEffect } from 'react'\r\nimport { useHistory } from 'react-router-dom';\r\nimport { authContext } from \"../context/AuthProvider\"\r\nimport checkLoginToRedirect from '../logic/checkLoginToRedirect';\r\n\r\nfunction Register() {\r\n\r\n  const history = useHistory();\r\n  const [ user ] = useContext( authContext );\r\n  const [ wrong, setWrong ] = useState(\"\");\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  useEffect(() => {\r\n    checkLoginToRedirect(user, history);\r\n  }, []);\r\n\r\n  return (\r\n    <main className=\"register-form\">\r\n      <h3 className=\"title\">Register</h3>\r\n      <form>\r\n        <input onChange={(e) => setUsername(e.target.value)} type=\"text\" className={`username ${wrong === \"username\" && \"error-primary\"}`} placeholder=\"Username\" value={username}/>\r\n        <input onChange={(e) => setPassword(e.target.value)} type=\"password\" className={`password ${wrong === \"password\" && \"error-primary\"}`} placeholder=\"Password\"  value={password}/>\r\n        <button onClick={register} className=\"register\">Register</button>\r\n      </form>\r\n    </main>\r\n  )\r\n\r\n  function register(e) {\r\n    e.preventDefault();\r\n    fetch(\"api/register\", {\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json'\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify({username, password})}\r\n    )\r\n    .then(res => res.json())\r\n    .then(result => {\r\n      console.log(result);\r\n      if(!result.error){\r\n        history.replace(\"/login\");\r\n        return;\r\n      }\r\n      if(result.cause === \"username\"){\r\n        setWrong(\"username\");\r\n      }\r\n      if(result.cause === \"password\"){\r\n        setWrong(\"password\");\r\n      }\r\n    })\r\n    .catch(err => {\r\n      console.log(err)\r\n      if(err) console.log(\"No se pudo enviar la data...\")\r\n    })\r\n  }\r\n}\r\n\r\n\r\nexport default Register\r\n","import React, { useContext, useEffect, useRef, useState } from 'react'\r\nimport { useHistory, Link } from 'react-router-dom';\r\nimport { authContext } from '../context/AuthProvider';\r\n\r\nfunction Comment({ source }) {\r\n\r\n  const [commentMode, setCommentMode] = useState(false);\r\n  const [showChildComments, setShowChildComments] = useState(false);\r\n  const [answerContent, setAnswerContent] = useState(\"\");\r\n  const [user] = useContext(authContext);\r\n  const [childComments, setChildComments] = useState(JSON.parse(source.children));\r\n  const { commenting, setCommenting } = source;\r\n  const history = useHistory();\r\n\r\n  const ref = useRef();\r\n\r\n\r\n  useEffect(() => {\r\n    document.activeElement.blur();\r\n    if(ref.current) ref.current.focus();\r\n  }, [commentMode])\r\n\r\n  return (\r\n    <article className={`comment ${source.id}`}>\r\n      <Link className=\"author\" to={source.author === user.id ? \"/profile\" : `/users/${source.author}`}>{source.authorName}</Link>\r\n      <p className=\"content\">\r\n        {source.content}\r\n      </p>\r\n      <ul className=\"actions\">\r\n        {commentMode ? \r\n          <>\r\n            <input ref={ref} value={answerContent} onChange={e => setAnswerContent(e.target.value)} type=\"text\" className=\"answer-comment\" />\r\n            <button onClick={addChild} className=\"send-answer-comment\">Send</button>\r\n            <button onClick={() => { \r\n              setCommentMode(false);\r\n              setCommenting(false); \r\n              }} className=\"abort-answer-comment\">&times;</button>\r\n          </>\r\n          :\r\n          <>\r\n            {!!childComments.length &&\r\n              <button onClick={toggleChildCommentsVisibility} className=\"see-more\">...</button>\r\n            }\r\n            <button onClick={() => { \r\n              if(commenting) return;\r\n              if(!user.logged) history.push(\"/login\");\r\n              setCommentMode(true);\r\n              setCommenting(true); \r\n              }} className=\"answer\">+</button>\r\n          </>\r\n        }\r\n        {user.id === source.author && <button onClick={(e) => deleteComment(e, source.id)} className=\"delete\"><i className=\"fa fa-trash\" aria-hidden=\"true\"></i></button>}\r\n      </ul>\r\n      <ol className=\"children\">\r\n        {!!childComments.length && showChildComments &&\r\n          childComments.map(child => <Comment key={child.id + 1000000000} source={{ ...child, childComments, setChildComments, commenting, setCommenting }} />)\r\n        }\r\n      </ol>\r\n    </article>\r\n  )\r\n\r\n  function deleteComment(e, id) {\r\n    \r\n    source.setChildComments(source.childComments.filter(comment => comment.id !== id));\r\n\r\n    fetch(\"/api/comment\", {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Accept\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({ id })\r\n    })\r\n      .then(res => res.json())\r\n      .then(result => console.log(result))\r\n      .catch(err => { if (err) console.log(err) })\r\n      .finally(() => { if(!document.querySelector(\".answer-comment\")) setCommenting(false) } )\r\n  }\r\n\r\n  function addChild(e) {\r\n    setCommentMode(false);\r\n    setCommenting(false);\r\n    setAnswerContent(\"\");\r\n    fetch(\"/api/comment/\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Accept\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({\r\n        topic: source.topic,\r\n        content: answerContent,\r\n        parent: source.id\r\n      })\r\n    })\r\n      .then(res => res.json())\r\n      .then(result => {\r\n        setChildComments([ ...childComments, result.data ]);\r\n        if(!showChildComments) toggleChildCommentsVisibility();\r\n      })\r\n      .catch(err => { if (err) console.log(err) })\r\n  }\r\n\r\n  function toggleChildCommentsVisibility() {\r\n    if (showChildComments === false) {\r\n      fetch(`/api/comment/${source.id}`)\r\n        .then(res => res.json())\r\n        .then(result => setChildComments(result))\r\n        .catch(err => console.log(err))\r\n        .finally(() => setShowChildComments(true))\r\n        return;\r\n    }\r\n    setShowChildComments(false);\r\n  }\r\n}\r\n\r\nexport default Comment\r\n","import React, { useEffect, useState, useContext } from 'react';\r\nimport { useHistory, useLocation } from 'react-router';\r\nimport Comment from '../components/Comment';\r\nimport { authContext } from '../context/AuthProvider';\r\n\r\nfunction Topic() {\r\n\r\n  const location = useLocation();\r\n  const { pathname } = location;\r\n  const [user] = useContext(authContext);\r\n  const [wrong, setWrong] = useState(\"\");\r\n  let [topic, setTopic] = useState(\"\");\r\n  const history = useHistory();\r\n  let [childComments, setChildComments] = useState([]);\r\n  const [commenting, setCommenting] = useState(false);\r\n  const [mainComment, setMainComment] = useState(\"\");\r\n  useEffect(() => {\r\n    console.log(\"/api\" + pathname);\r\n    fetch(\"/api\" + pathname)\r\n      .then(res => res.json())\r\n      .then(result => {\r\n        const { topic: resTopic, comments: resComments } = result;\r\n        setTopic(resTopic);\r\n        setChildComments(resComments);\r\n        console.log(resTopic);\r\n      })\r\n      .catch(err => { if (err) console.log(err) })\r\n  }, [])\r\n\r\n  return (\r\n    <>\r\n      <main className=\"topic\">\r\n        <h3 className=\"title\">{topic?.subject}</h3>\r\n        <p className=\"intro\">{topic?.intro}</p>\r\n      </main>\r\n      <article className=\"actions\">\r\n        <input type=\"text\" className={`comment-content ${wrong === \"main\" && \"error-primary\"}`} onChange={(e) => setMainComment(e.target.value)} value={mainComment} />\r\n        <button className=\"add-comment\" onClick={addMainComment}>+</button>\r\n      </article>\r\n      <section className=\"comments\">\r\n        {childComments.map(comment => <Comment key={comment.id + 10000000} source={{ ...comment, childComments, setChildComments, commenting, setCommenting }} />\r\n        )\r\n        }\r\n      </section>\r\n    </>\r\n  )\r\n\r\n  function addMainComment() {\r\n\r\n    if(!user.logged) history.push(\"/login\");\r\n\r\n    if (!(mainComment.length)) {\r\n      setWrong(\"main\");\r\n      return;\r\n    }\r\n\r\n    setWrong(\"\");\r\n\r\n    fetch(\"/api/comment\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Accept\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({\r\n        topic: topic.id,\r\n        parent: null,\r\n        content: mainComment\r\n      })\r\n    })\r\n      .then(res => res.json())\r\n      .then(result => {\r\n        setMainComment(\"\");\r\n        setChildComments([...childComments, { ...result.data, authorName: user.username }]);\r\n      })\r\n      .catch(err => console.log(err))\r\n  }\r\n}\r\n\r\nexport default Topic\r\n","import React, { useState } from 'react'\r\n\r\nfunction TopicCreate() {\r\n\r\n  const [ subject, setSubject ] = useState(\"\");\r\n  const [ intro, setIntro ] = useState(\"\");\r\n \r\n  return (\r\n    <main className=\"create-topic\">\r\n      <h3 className=\"title\">What topic would you like to create?</h3>\r\n      <form className=\"topic-info\">\r\n        <input placeholder=\"Topic's title\" type=\"text\" className=\"subject\" value={subject} onChange={ e => setSubject(e.target.value)}/>\r\n        <textarea placeholder=\"A small introduction...\" className=\"intro\" value={intro} onChange={ e => setIntro(e.target.value)}></textarea>\r\n        <button className=\"create\" onClick={sendNewTopic}>Create!</button>\r\n      </form>\r\n    </main>\r\n  )\r\n\r\n  function sendNewTopic(e){\r\n    e.preventDefault();\r\n    if(!subject.length || !intro.length) return;\r\n    const formattedSubject = formatText(subject);\r\n    const formattedIntro = formatText(intro);\r\n    const topic = { subject: formattedSubject, intro: formattedIntro };\r\n    fetch(\"/api/topics\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Accept\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({ ...topic })\r\n    })\r\n    .then(res => res.json())\r\n    .then(result => {\r\n      console.log(result);   \r\n      setIntro(\"\");\r\n      setSubject(\"\");\r\n    })\r\n    .catch(err => console.log(err))\r\n  }\r\n\r\n  function formatText(text){\r\n    return text.charAt(0).toUpperCase() + text.slice(1);\r\n  }\r\n}\r\n\r\nexport default TopicCreate\r\n","import React, { useContext } from 'react'\r\nimport { useState } from 'react'\r\nimport { useQuery } from 'react-query';\r\nimport { Link, Route, useRouteMatch, Switch } from 'react-router-dom';\r\nimport { client } from '../../App';\r\nimport { authContext } from '../context/AuthProvider';\r\nimport Topic from './Topic';\r\nimport TopicCreate from './TopicCreate';\r\n\r\nfunction Topics() {\r\n\r\n  const [user] = useContext(authContext);\r\n  const topics = useQuery(\"topics\", () => fetch(\"/api/topics\").then(res => res.json()));\r\n  console.log(topics);\r\n\r\n  const { path } = useRouteMatch();\r\n\r\n  return (\r\n    <Switch>\r\n      <Route exact path={path}>{\r\n        topics.isLoading ?\r\n          <div> Loading... </div>\r\n          :\r\n          topics.isError ?\r\n            <div> There was an error, please refresh </div>\r\n            :\r\n            <>\r\n              {user.logged &&\r\n                <section className=\"create-topic\">\r\n                  <Link to={`${path}/create`} className=\"add-topic\">Add a new topic!</Link>\r\n                </section>\r\n              }\r\n              <main className=\"topics\">\r\n                {topics.data.data.map(topic =>\r\n                  <article key={topic.id} className={`topic ${topic.id}`}>\r\n                    <Link to={`${path}/${topic.id}`} >\r\n                      <div className=\"rating\">{\r\n                        [1, 2, 3, 4, 5].map(rate => rate <= topic.rating ? <i key={rate} className=\"fas fa-star\"></i> : <i key={rate + 100} className=\"far fa-star\"></i>)\r\n                      }</div>\r\n                      <h3 className=\"title\">{topic.subject}</h3>\r\n                      <p className=\"content\">\r\n                        {topic.intro}\r\n                      </p>\r\n                      <h4 className=\"founder\">{topic.authorName}</h4>\r\n                    </Link>\r\n                    {topic.author === user.id && <button onClick={() => deleteTopic(topic.id)} className=\"delete\"><i className=\"fa fa-trash\" aria-hidden=\"true\" /></button>}\r\n                  </article>\r\n                )}\r\n              </main>\r\n            </>\r\n      }\r\n      </Route>\r\n      <Route path={`${path}/create`} component={TopicCreate} />\r\n      <Route exact path={`${path}/:id`} component={Topic} />\r\n    </Switch>\r\n  )\r\n\r\n  function deleteTopic(id) {\r\n    fetch(\"/api/topics\", {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"Accept\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({ id })\r\n    })\r\n      .then(res => res.json())\r\n      .then(result => {\r\n        console.log(result);\r\n        client.invalidateQueries(\"topics\");\r\n      })\r\n      .catch(err => console.log(err))\r\n  }\r\n}\r\n\r\nexport default Topics\r\n","import React, { useEffect } from 'react'\r\nimport { useQuery } from 'react-query';\r\nimport { useRouteMatch } from 'react-router-dom';\r\nimport { client } from '../../App';\r\n\r\nfunction Users() {\r\n\r\n  const url = useRouteMatch();\r\n  const { id } = url.params;\r\n\r\n  let anotherUser = useQuery(\"anotheruser\", () => fetch(\"/api/users/\" + id).then(res => res.json()), { cacheTime: 0 });\r\n\r\n  return (\r\n    <main className=\"profile user\">\r\n      {anotherUser.isLoading ?\r\n        <div className=\"loading\">It is loading...</div>\r\n        :\r\n        anotherUser.isError ?\r\n          <div className=\"error\">There was an error fetching. Please log out and try again</div>\r\n          :\r\n          <>\r\n\r\n            <div className=\"avatar-section\">\r\n              <img className=\"image-picker\" src={\"/\" + anotherUser.data.data.profile_image} alt=\"Profile\" />\r\n            </div>\r\n            <div className=\"content\">\r\n              <h3 className=\"name\">{anotherUser.data.data.username}</h3>\r\n              <p>{anotherUser.data.data.profile_info}</p>\r\n            </div>\r\n          </>\r\n      }\r\n    </main>\r\n  )\r\n}\r\n\r\nexport default Users\r\n","import React, { useContext } from 'react'\r\nimport { Redirect, Route, useLocation } from 'react-router';\r\nimport { authContext } from '../context/AuthProvider'\r\n\r\nfunction PrivateRoute(props) {\r\n\r\n  const [user] = useContext(authContext);\r\n  const {logged} = user;\r\n  const location = useLocation();\r\n\r\n  return ( \r\n    <>\r\n    {logged ? \r\n      <Route {...props} />\r\n      :\r\n      <Redirect to={\r\n        {pathname: \"/login\", state: {from: location}}\r\n      } />\r\n    }\r\n    </>\r\n  )\r\n}\r\n\r\nexport default PrivateRoute\r\n","import React, { useContext } from 'react'\r\nimport { Redirect, Route, useLocation } from 'react-router';\r\nimport { authContext } from '../context/AuthProvider'\r\n\r\nfunction PublicRoute(props) {\r\n\r\n  const [ user ] = useContext(authContext);\r\n  console.log(user.logged ? \"Already logged\" : \"Isnt logged yet\");\r\n  const { logged } = user;\r\n\r\n  return ( \r\n    <>\r\n    {!logged ? \r\n      <Route {...props} />\r\n      :\r\n      <Redirect to={\r\n        { pathname: \"/\" }\r\n      } />\r\n    }\r\n    </>\r\n  )\r\n}\r\n\r\nexport default PublicRoute\r\n","import React from 'react';\r\nimport { Switch, Route } from \"react-router-dom\";\r\nimport Home from '../pages/Home';\r\nimport Login from '../pages/Login';\r\nimport Profile from '../pages/Profile';\r\nimport Register from '../pages/Register';\r\nimport Topics from '../pages/Topics';\r\nimport Users from '../pages/Users';\r\nimport PrivateRoute from './PrivateRoute';\r\nimport PublicRoute from './PublicRoute';\r\n\r\nfunction AllRoutes() {\r\n  return (\r\n    <Switch>\r\n      <Route exact path=\"/\" component={Home} />\r\n      <PublicRoute path=\"/login\" component={Login} />\r\n      <PublicRoute path=\"/register\" component={Register} />\r\n      <PrivateRoute path=\"/profile\" component={Profile} />\r\n      <Route path=\"/topics\" component={Topics} />\r\n      <Route path=\"/users/:id\" component={Users} />\r\n    </Switch>\r\n  )\r\n}\r\n\r\nexport default AllRoutes\r\n","import React from \"react\";\r\nimport {\r\n  BrowserRouter as Router,\r\n} from \"react-router-dom\";\r\nimport Header from \"./scripts/components/Header\";\r\nimport AuthProvider from \"./scripts/context/AuthProvider\";\r\nimport AllRoutes from \"./scripts/routes/AllRoutes\";\r\nimport { QueryClientProvider, QueryClient } from \"react-query\";\r\n\r\n\r\nconst client = new QueryClient();\r\nexport { client }\r\n\r\nfunction App() {\r\n\r\n  return (\r\n    <QueryClientProvider client={client}>\r\n      <AuthProvider>\r\n        <Router>\r\n          <Header />\r\n          <AllRoutes />\r\n        </Router>\r\n      </AuthProvider>\r\n    </QueryClientProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles.css';\nimport App from './App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);"],"sourceRoot":""}